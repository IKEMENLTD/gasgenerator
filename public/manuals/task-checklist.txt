========================================
必須タスクチェックリスト 使い方説明書
========================================

■ このシステムでできること
────────────────────────────
業務で繰り返し発生するタスクを「テンプレート」として登録し、
案件ごとにチェックリストを作成して進捗管理できるシステムです。

・新規案件受注時、入社手続き、月末締め処理など、毎回同じタスクが発生する業務に最適
・テンプレートからワンクリックでチェックリストを生成
・タスクの完了/未完了をチェックボックスで管理
・期限超過タスクの自動検知とアラート通知（メール/Slack）
・漏れ発生率の分析で改善ポイントを可視化
・スマートフォン対応（外出先でもチェック可能）


========================================
■ 画面構成と使い方
========================================

【1. ダッシュボード】
────────────────────────────
アプリを開くと最初に表示される画面です。

＜統計カード＞
  ・総チェックリスト数 … 作成したチェックリストの合計
  ・完了 … 全タスクが完了したチェックリスト数
  ・進行中 … 作業中のチェックリスト数
  ・期限超過タスク … 期限を過ぎた未完了タスクの数

＜最近のチェックリスト＞
  ・直近5件のチェックリストが表示されます
  ・案件名をクリックすると詳細画面に移動します

＜漏れ発生率TOP5＞
  ・期限超過が多いタスクを発生率の高い順に表示します
  ・どのタスクで遅延が起きやすいかが一目でわかります
  ・発生率の色: 緑(10%以下) / 黄(10〜30%) / 赤(30%超)


【2. チェックリスト一覧】
────────────────────────────
作成した全チェックリストの一覧です。

＜フィルター機能＞
  ・画面上部のプルダウンでステータスを絞り込めます
    - すべてのステータス
    - 進行中
    - 完了
    - 期限超過

＜一覧の表示内容＞
  ・案件ID / 案件名 / 基準日 / ステータス / 進捗率 / 担当者

＜操作＞
  ・「開く」ボタンでチェックリスト詳細画面に移動


【3. チェックリスト詳細】
────────────────────────────
チェックリストの個別タスクを確認・操作する画面です。

＜ヘッダー部分＞
  ・案件名、案件ID、基準日が表示されます
  ・ステータスバッジ（進行中/完了/期限超過）
  ・完了率（パーセント表示 + プログレスバー）

＜タスク一覧＞
  各タスクには以下が表示されます:
  ・チェックボックス … クリックで完了/未完了を切り替え
  ・タスク名
  ・完了情報（完了者、完了日時）
  ・期限日（期限超過の場合は赤字表示）

＜タスクの完了操作＞
  1. タスク左のチェックボックスをクリック
  2. 自動的に完了日時と完了者が記録されます
  3. もう一度クリックすると未完了に戻せます

＜「一覧に戻る」＞
  ・左上の「← 一覧に戻る」でチェックリスト一覧に戻ります


【4. テンプレート管理】
────────────────────────────
チェックリストの元となるテンプレートを管理する画面です。

＜テンプレート一覧＞
  ・テンプレートID / テンプレート名 / カテゴリ / タスク数 / 更新日

＜新規テンプレート作成＞
  1. 「+ 新規テンプレート」ボタンをクリック
  2. テンプレート名を入力（例: 新規案件受注時）
  3. カテゴリを選択（営業/制作/人事/経理/総務）
  4. タスクを追加:
     - タスク名を入力
     - 期限(日)を設定（基準日から何日後か）
     - 必須/任意を選択
     - 「+ タスクを追加」で行を増やせます
  5. 「テンプレートを作成」ボタンで保存

＜テンプレート編集＞
  1. 一覧の「編集」ボタンをクリック
  2. 基本情報（テンプレート名・カテゴリ）を変更 →「基本情報を保存」
  3. 既存タスクの編集:
     - タスク名、期限(日)、必須/任意を変更 →「保存」
     - 不要なタスクは「削除」で除去
  4. 新規タスク追加:
     - 画面下部のフォームにタスク名等を入力 →「追加」

＜テンプレート削除＞
  ・一覧の「削除」ボタンをクリック
  ・確認ダイアログで「OK」を選ぶと削除されます
  ・関連するタスク定義もすべて削除されます（注意）


【5. 新規チェックリスト作成】
────────────────────────────
テンプレートからチェックリストを作成する画面です。

＜入力項目＞
  ・案件ID … 案件を識別するID（例: PRJ001）
  ・案件名 … 案件の名前（例: 株式会社ABC様 Webサイト制作）
  ・テンプレート … 使用するテンプレートを選択
  ・基準日 … タスクの期限計算の基準となる日付
  ・担当者 … チェックリストの担当者名

＜テンプレートプレビュー＞
  ・テンプレートを選択すると、そのタスク一覧が表示されます
  ・各タスクの期限(基準日+○日)と必須/任意が確認できます

＜作成＞
  ・「チェックリストを作成」ボタンで作成
  ・作成後、自動的にチェックリスト一覧に移動します


【6. アラートログ】
────────────────────────────
システムが送信したアラートの履歴を確認する画面です。

＜表示内容＞
  ・案件名 / 通知種別（Email/Slack） / 送信日時
  ・未完了タスク数 / 期限超過タスク名

＜更新＞
  ・「更新」ボタンで最新のログを再読み込みします


【7. 設定】
────────────────────────────
通知設定の状態確認と設定方法の説明画面です。

＜通知設定の状態表示＞
  ・Slack通知: 設定済み/未設定
  ・メール通知: 設定済み/未設定（設定済みならアドレスも表示）
  ・日次トリガー: 有効/未設定

＜Slack通知の設定方法＞
  1. Slack管理画面で「Incoming Webhooks」アプリを追加
  2. 通知を送信したいチャンネルを選択
  3. 生成されたWebhook URLをコピー
  4. Apps Scriptエディタで CONFIG.SLACK_WEBHOOK_URL にURLを設定
  5. 新しいデプロイを作成

＜メール通知の設定方法＞
  1. Apps Scriptエディタで CONFIG.NOTIFICATION_EMAIL にメールアドレスを設定
  2. 新しいデプロイを作成

＜日次アラートトリガー＞
  ・毎日午前9時に期限超過タスクを自動チェックし、アラートを送信
  ・設定: Apps Scriptエディタで setupDailyTrigger 関数を実行
  ・解除: removeDailyTrigger 関数を実行


========================================
■ スプレッドシートのシート構成
========================================

本システムは以下の5つのシートでデータを管理しています。
直接スプレッドシートを開いてデータを確認することもできます。

【テンプレートマスタ】
  テンプレートID / テンプレート名 / カテゴリ / タスク数 / 作成日 / 最終更新日

【タスク定義】
  タスクID / テンプレートID / タスク順序 / タスク名 / タスク詳細・注意点 / 必須・任意 / 期限目安（日） / 担当ロール

【案件チェックリスト】
  チェックリストID / 案件ID / 案件名 / テンプレートID / 基準日 / 作成日時 / ステータス / 完了率 / 担当者

【タスク実行管理】
  実行ID / チェックリストID / 案件名 / タスクID / タスク名 / 期限日 / 完了フラグ / 完了日時 / 完了者 / 備考

【アラートログ】
  送信日時 / チェックリストID / 案件名 / 未完了タスク数 / 期限超過タスク / 通知先 / 送信結果


========================================
■ 活用例
========================================

・新規案件の受注時 → 受注テンプレートからチェックリストを作成し、契約書確認・稟議申請・CRM登録などの漏れを防止
・月末の締め処理 → 経理テンプレートで売上確定・請求書発行・経費精算などを確実に実行
・入社手続き → 人事テンプレートで雇用契約・社会保険・PC準備などの手続きを管理
・制作プロジェクト開始 → 制作テンプレートで要件定義確認・WBS作成・デザイン方針決定などを追跡
・独自テンプレートの作成 → 自社の業務に合わせたテンプレートを自由に作成可能


========================================
■ よくある質問
========================================

Q. チェックリストを削除したい場合は？
A. 現在、画面からの削除機能はありません。スプレッドシートの「案件チェックリスト」シートと「タスク実行管理」シートから該当行を直接削除してください。

Q. テンプレートのタスク順序を変えたい場合は？
A. スプレッドシートの「タスク定義」シートで「タスク順序」列の数値を変更してください。

Q. 基準日とは何ですか？
A. タスクの期限を計算する起点となる日付です。例えば基準日が4/1でタスクの期限が「基準日+3日」の場合、期限は4/4になります。マイナスの日数も設定可能です（例: -5日 → 基準日の5日前）。

Q. 複数人で使えますか？
A. はい。GASウェブアプリのURLを共有すれば、複数人で同じチェックリストを操作できます。デプロイ時に「アクセスできるユーザー」を「全員」に設定してください。
