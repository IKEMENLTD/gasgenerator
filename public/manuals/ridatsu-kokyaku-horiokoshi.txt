========================================
離脱顧客掘り起こしツール 使い方説明書
========================================

■ このツールでできること
────────────────────────
・来店が途絶えた「離脱顧客」を自動で検出・分類する
・離脱期間に応じたセグメント（3ヶ月/6ヶ月/1年）で管理する
・セグメントごとにメールキャンペーンを一括送信する
・クーポンを自動発行し、使用状況を追跡する
・顧客の復帰（再来店）を自動で記録・集計する
・ダッシュボードで離脱状況・復帰率・クーポン使用率を一覧把握する

美容室・サロン・飲食店・小売店など、リピート顧客が重要な
業種での「休眠顧客の掘り起こし」に最適です。


========================================
■ 画面の説明（全タブ）
========================================

【1. ダッシュボード】
────────────────────────
ツールを開くと最初に表示される画面です。

表示される統計:
 ・総顧客数 … 登録されている全顧客の数
 ・アクティブ … 現在アクティブな顧客数
 ・離脱顧客 … 3ヶ月以上来店がない顧客の合計
 ・復帰率 … キャンペーン送信後に再来店した割合
 ・クーポン使用率 … 発行したクーポンのうち使用された割合
 ・総送信数 … これまでに送信したキャンペーンメールの総数

離脱セグメント内訳:
 ・3ヶ月離脱 / 6ヶ月離脱 / 1年離脱 の人数をバーグラフで表示

セグメント別復帰率:
 ・各セグメントごとの送信数・復帰数・復帰率を表示


【2. 顧客管理】
────────────────────────
全顧客の一覧を確認・管理する画面です。

表示項目:
 ・顧客ID / 氏名 / メール / 最終来店日 / 来店回数 / 累計売上 / ステータス

操作:
 ・「+ 顧客追加」ボタン → 新しい顧客を登録
   入力項目: 氏名、メールアドレス、電話番号、初回売上
 ・「+ 取引登録」ボタン → 既存顧客の来店・購入を記録
   入力項目: 顧客ID、利用メニュー、売上金額、担当者、クーポンコード（任意）
   ※ 取引登録すると最終来店日・累計売上・来店回数が自動更新されます
   ※ クーポンコードを入力すると自動で使用済みになります
   ※ 離脱顧客の場合は復帰フラグが自動で更新されます


【3. 離脱顧客】
────────────────────────
来店が途絶えた顧客をセグメント別に表示する画面です。

セグメントタブ:
 ・3ヶ月離脱 … 最終来店から90日〜179日経過した顧客
 ・6ヶ月離脱 … 最終来店から180日〜364日経過した顧客
 ・1年離脱 … 最終来店から365日以上経過した顧客

表示項目:
 ・顧客ID / 氏名 / メール / 最終来店日 / 経過日数 / 累計売上

操作:
 ・「ステータス更新」ボタン → 全顧客のステータスを最終来店日から
   再計算して更新します（アクティブ/離脱3ヶ月/離脱6ヶ月/離脱1年）


【4. キャンペーン管理】
────────────────────────
離脱顧客向けのメールキャンペーンを管理・送信する画面です。

キャンペーン一覧:
 ・登録済みのキャンペーンがカード形式で表示されます
 ・対象セグメント、有効期間、メール件名、クーポン内容を確認できます

操作:
 ・「+ キャンペーン作成」ボタン → 新しいキャンペーンを作成
   入力項目: キャンペーン名、対象セグメント、メール件名、メール本文、
             クーポン内容、有効日数
   メール本文で使える変数:
     {name} … 顧客の氏名
     {coupon_code} … 自動生成されるクーポンコード
     {expiry_date} … クーポンの有効期限

 ・キャンペーン送信:
   1. 「セグメントを選択」でセグメントを選ぶ
   2. 「送信実行」ボタンを押す
   3. 確認ダイアログで「OK」を押すと、該当セグメントの全顧客にメール送信
   ※ 送信時にクーポンが自動発行され、クーポン発行ログと送信ログに記録されます


【5. クーポン管理】
────────────────────────
発行されたクーポンの一覧と使用状況を管理する画面です。

表示項目:
 ・クーポンコード / 顧客名 / 発行日 / 有効期限 / 状態（未使用/使用済）

操作:
 ・「使用済にする」ボタン → 未使用のクーポンを手動で使用済みに変更
   ※ 取引登録時にクーポンコードを入力した場合は自動で使用済みになります


【6. 送信ログ】
────────────────────────
キャンペーンメールの送信履歴を確認する画面です。

表示項目:
 ・送信日時 / 顧客名 / メール / キャンペーンID / 結果（成功/失敗）/ 復帰


========================================
■ スプレッドシートのシート構成
========================================

【顧客マスタ】
 顧客ID / 氏名 / メールアドレス / 電話番号 / 初回来店日 /
 最終来店日 / 累計来店回数 / 累計売上金額 / 顧客ステータス

【取引履歴】
 取引ID / 顧客ID / 取引日 / 利用メニュー / 売上金額 / 担当者

【キャンペーン設定】
 キャンペーンID / キャンペーン名 / 対象セグメント / メール件名 /
 メール本文 / クーポン内容 / クーポン有効日数 / 有効フラグ

【クーポン発行ログ】
 クーポンコード / 顧客ID / 氏名 / 発行日 / 有効期限 /
 使用済フラグ / 使用日

【送信ログ】
 送信日時 / 顧客ID / 氏名 / メールアドレス / キャンペーンID /
 クーポンコード / 送信結果 / 復帰フラグ


========================================
■ 基本的な使い方の流れ
========================================

1. 顧客を登録する
   → 「顧客管理」タブ →「+ 顧客追加」で顧客情報を入力

2. 来店・取引を記録する
   → 「顧客管理」タブ →「+ 取引登録」で取引情報を入力

3. 離脱顧客を確認する
   → 「離脱顧客」タブでセグメント別に確認
   → 必要に応じて「ステータス更新」を実行

4. キャンペーンを設定する
   → 「キャンペーン」タブ →「+ キャンペーン作成」
   → 対象セグメントとメール内容を設定

5. キャンペーンを送信する
   → 「キャンペーン」タブでセグメントを選択 →「送信実行」

6. 効果を確認する
   → 「ダッシュボード」で復帰率やクーポン使用率を確認
   → 「送信ログ」で個別の送信結果を確認
   → 「クーポン」タブでクーポン使用状況を確認

7. 復帰した顧客の来店を記録する
   → 「顧客管理」タブ →「+ 取引登録」で記録
   → クーポンコードを入力すると自動で使用済みに
   → 送信ログの復帰フラグも自動で更新


========================================
■ 週次自動処理について
========================================

スプレッドシートのメニュー「離脱顧客ツール」→「トリガー設定」を
実行すると、毎週月曜9:00に以下の処理が自動実行されます:

 1. 全顧客のステータスを自動更新
 2. 各セグメントに設定済みキャンペーンを自動送信

手動で即時実行したい場合:
 → メニュー「離脱顧客ツール」→「週次処理を実行」


========================================
■ 注意事項
========================================

・メール送信にはGmailを使用します。1日の送信上限はGoogleアカウントの
  種類により異なります（無料: 100通/日、Workspace: 1500通/日）
・クーポンコードは顧客ID+日付+ランダム文字列で自動生成されます
・スプレッドシートのデータを直接編集することも可能ですが、
  列の順序や形式を変更しないでください
