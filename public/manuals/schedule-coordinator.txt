===================================================
日程調整自動化 - 使い方説明書
===================================================

■ このツールでできること
---------------------------------------------------
「いつ空いてます?」「その日は難しくて...」というメールの
やり取りを自動化するツールです。

- Googleカレンダーから空き時間を自動抽出して候補を提案
- 参加者にメールで候補日時を送信し、回答を受付
- 全員の回答が揃ったら自動で日程を確定
- 確定した予定をGoogleカレンダーに自動登録（Meet URL付き）
- 未回答者へのリマインドメールを自動送信
- 月次のパフォーマンスレポートを自動生成

営業の商談調整、採用面接、社内MTG、1on1など
あらゆる日程調整に対応しています。


===================================================
■ 初回セットアップ
===================================================

1. ウェブアプリにアクセスする
2. Googleの承認画面が表示されたら「許可」を押す
3. 画面右上のハンバーガーメニューから「設定」を開く
4. 「シート初期化」ボタンを押す
   → スプレッドシートに15枚のシートが自動作成される
5. 「トリガー設定」ボタンを押す
   → 自動処理（リマインド・レポート等）が登録される
6. 「ユーザー管理」タブでユーザーを登録する


===================================================
■ 各タブの使い方
===================================================

-----------------------------
1. ダッシュボード
-----------------------------
アプリを開くと最初に表示される画面です。

表示内容:
- 総調整数 / 進行中 / 今月確定 / 確定率 / 回答待ち
- 確定率推移グラフ（過去6ヶ月の棒グラフ）
- 調整種別内訳グラフ（1対1/複数人/社内MTGの割合）
- 進行中の調整一覧（詳細ボタンで詳細画面へ）
- 回答待ち一覧（未回答の参加者が誰か確認）
- 今週の確定予定一覧

-----------------------------
2. 新規調整
-----------------------------
日程調整リクエストを新規作成する画面です。

手順:
(1) テンプレート選択（任意）
    登録済みテンプレートがあれば選択すると
    所要時間・形式・期間が自動入力される

(2) 基本情報を入力
    - リクエスト名: 「田中様_初回商談」など
    - 作成者: ユーザー管理で登録したユーザーを選択
    - 調整種別: 1対1 / 複数人 / 社内MTG
    - 所要時間: 分単位（15分刻み）
    - 開催形式: オンライン / 対面 / どちらでも
    - 場所/URL: 対面の場合は場所、空欄ならMeet自動生成
    - 調整期間: 候補を探す日付範囲
    - 候補提示数: 自動生成する候補の最大数
    - 回答期限: 参加者の回答期限日
    - 自動確定: ONなら全員回答後に自動で日程確定

(3) 参加者を追加
    - 氏名とメールアドレスを入力
    - 種別（社外/社内）、会社名、必須/任意を設定
    - 「参加者を追加」ボタンで追加（複数名可）

(4) 「調整リクエストを作成」ボタンを押す
    以下が自動で実行される:
    → リクエスト作成
    → 参加者登録
    → カレンダーから候補日時を自動生成
    → 参加者に招待メールを送信
    進捗がステップ表示で確認できる

-----------------------------
3. 調整一覧
-----------------------------
作成した全リクエストの一覧画面です。

- ステータスフィルター: 全て/作成中/募集中/確定済/期限切れ/キャンセル
- 「詳細」ボタンでリクエスト詳細画面へ

リクエスト詳細画面でできること:
- 基本情報の確認
- 参加者一覧と回答状況の確認
- 候補日時の一覧とOK/NG数の確認
- 回答一覧（誰がどの候補に何と回答したか）
- 候補生成: カレンダーから再度候補を生成
- 招待メール: 参加者にメールを再送信
- リマインド: 未回答者にリマインドを送信
- 手動確定: 任意の候補で日程を手動確定
- キャンセル: リクエストをキャンセル

-----------------------------
4. 確定予定
-----------------------------
日程が確定した予定の一覧画面です。

表示内容:
- リクエスト名
- 確定した日時
- 所要時間
- 開催形式
- 確定方法（自動/手動）

-----------------------------
5. ユーザー管理
-----------------------------
システムを利用するユーザーを管理する画面です。

登録項目:
- 氏名、メールアドレス（必須）
- 部署、役職
- 調整可能時間帯（開始/終了）: 候補生成の範囲
- デフォルト所要時間: リクエスト作成時の初期値
- バッファ時間: 前後の余裕時間（分）
- 除外曜日: 候補に含めない曜日（例: 土,日）
- Zoom URL: 固定のZoom会議URL
- Meet自動生成: ONなら確定時にMeet URLを自動生成

操作:
- 「ユーザー追加」で新規登録
- 「編集」で情報を更新
- 「削除」で無効化（データは残る）

-----------------------------
6. テンプレート
-----------------------------
よく使う調整パターンをテンプレートとして保存できます。

登録項目:
- テンプレート名: 初回商談、定例MTG、面接、1on1 など
- 所要時間、開催形式
- デフォルト場所/URL
- 調整期間（日数）
- 候補提示数
- メール件名テンプレート
- メール本文テンプレート

新規調整作成時にテンプレートを選択すると、
設定値が自動で入力されます。

-----------------------------
7. 設定
-----------------------------
システム全体の設定画面です。

(1) シート初期化
    スプレッドシートに必要な15シートを作成する
    （初回のみ実行）

(2) トリガー設定
    以下の自動処理を登録する:
    - 毎時: 空き時間キャッシュ更新、期限切れチェック
    - 毎日9時: 未回答者へリマインドメール
    - 毎日17時: 翌日の予定リマインドメール
    - 毎週月曜: 週次レポートメール
    - 毎月1日: 月次パフォーマンス集計

(3) アラート設定
    自動検知の条件一覧:
    - 未回答24時間経過
    - 回答期限接近（12時間前）
    - 長期未確定（72時間）

(4) 未回答アラート
    現在の未回答者一覧が表示される


===================================================
■ 参加者の回答方法（外部参加者向け）
===================================================

1. 招待メールに記載されたURLをクリック
2. リクエスト情報（件名・所要時間・形式等）を確認
3. 各候補日時について回答を選択
   ○ = 参加可能
   △ = できれば可能
   × = 参加不可
4. コメント欄に補足があれば入力（任意）
5. 「回答を送信」ボタンを押す
6. 「回答完了」画面が表示されたら完了


===================================================
■ 自動確定の仕組み
===================================================

自動確定がONの場合:
1. 必須参加者が全員回答済みになる
2. OK数が最も多い候補が自動で選ばれる
3. 以下が自動実行される:
   - Googleカレンダーにイベント登録
   - Meet URL自動生成（設定がONの場合）
   - 全参加者に確定通知メール送信
   - リクエストのステータスが「確定済」に変更


===================================================
■ スプレッドシートのシート構成（15シート）
===================================================

1.  ユーザーマスタ: ユーザー情報
2.  調整リクエストマスタ: リクエスト情報
3.  参加者マスタ: リクエストごとの参加者
4.  候補日時データ: 候補スロット情報
5.  回答データ: 参加者の回答内容
6.  確定予定データ: 確定した予定
7.  調整URL管理: 発行したURL
8.  リマインド履歴: メール送信ログ
9.  調整パフォーマンス: 月次集計データ
10. 調整種別サマリー: 種別ごとの月次集計
11. 空き時間キャッシュ: カレンダーデータのキャッシュ
12. テンプレートマスタ: テンプレート情報
13. 未回答アラートリスト: 未回答検知結果
14. アラート設定: アラートルール
15. ダッシュボード: 集計用シート


===================================================
■ こんなときに使えます
===================================================

- 営業の商談日程調整
  → 相手先にURLを送るだけで候補選択してもらえる

- 採用面接の日程調整
  → 複数の面接官と候補者の空き時間をマッチング

- 社内定例MTGの調整
  → 参加者全員のカレンダーから自動で空き時間抽出

- 1on1ミーティング
  → テンプレート化して毎回の手間を削減

- コンサルティングの打ち合わせ
  → 複数クライアントの調整を一元管理

- カスタマーサクセスの定期面談
  → リマインド自動送信で連絡漏れ防止


===================================================
■ 注意事項
===================================================

- カレンダー連携はアプリをデプロイしたGoogleアカウントの
  カレンダーが対象です
- Meet URL自動生成にはGoogleカレンダーの権限が必要です
- メール送信にはGASの日次送信上限があります
  （無料アカウント: 100通/日、Workspace: 1500通/日）
- 回答URLはGASウェブアプリのURLにパラメータを付与した
  形式です
